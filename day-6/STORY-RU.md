# День 6: Прогулка охранника

Историки снова используют своё изысканное устройство, на этот раз чтобы перенести вас всех в лабораторию по производству прототипов костюмов на Северном полюсе... в 1518 год! Оказывается, иметь прямой доступ к истории очень удобно для группы историков.

Тем не менее, вам всё равно нужно быть осторожным с временными парадоксами, поэтому важно избегать контакта с кем-либо из 1518 года, пока Историки ищут начальника. К сожалению, в этой части лаборатории патрулирует один охранник.

Может быть, вы сможете заранее определить, куда пойдёт охранник, чтобы Историки могли безопасно продолжить свои поиски?

Вы начинаете с составления карты (ваш ввод задачи), которая описывает ситуацию. Например:

```
....#.....
.........#
..........
..#.......
.......#..
..........
.#..^.....
........#.
#.........
......#...
```

На карте текущее положение охранника обозначено символом ^ (чтобы указать, что охранник в данный момент смотрит вверх относительно карты). Любые препятствия — ящики, столы, алхимические реакторы и т. д. — обозначены символом #.

Охранники лаборатории в 1518 году строго следуют протоколу патрулирования, который включает в себя следующие действия:

1. Если прямо перед охранником есть препятствие, он поворачивает направо на 90 градусов.
2. В противном случае он делает шаг вперёд.

Следуя этому протоколу, охранник несколько раз поднимается вверх, пока не сталкивается с препятствием (в данном случае, с кучей неудачных прототипов костюмов):

```
....#.....
....^....#
..........
..#.......
.......#..
..........
.#........
........#.
#.........
......#...
```

Поскольку теперь перед охранником есть препятствие, он поворачивает направо, прежде чем продолжить движение прямо в новом направлении:

```
....#.....
........>#
..........
..#.......
.......#..
..........
.#........
........#.
#.........
......#...
```

Достигнув другого препятствия (катушка с длинными полимерами), охранник снова поворачивает направо и продолжает движение вниз:

```
....#.....
.........#
..........
..#.......
.......#..
..........
.#......v.
........#.
#.........
......#...
```

Этот процесс продолжается какое-то время, но в конце концов охранник покидает область, показанную на карте (после прохождения мимо резервуара с универсальным растворителем):

```
....#.....
.........#
..........
..#.......
.......#..
..........
.#........
........#.
#.........
......#v..
```

Предсказав маршрут охранника, вы можете определить, какие конкретные позиции в лаборатории будут входить в его маршрут патрулирования. Включая стартовую позицию охранника, позиции, посещённые им перед покиданием области, обозначены символом X:

```
....#.....
....XXXXX#
....X...X.
..#.X...X.
..XXXXX#X.
..X.X.X.X.
.#XXXXXXX.
.XXXXXXX#.
#XXXXXXX..
......#X..
```

В этом примере охранник посетит 41 уникальную позицию на карте.

Определите маршрут охранника. **Сколько уникальных позиций посетит охранник перед тем, как покинет область?**

## Часть вторая

Пока Историки работают над обходом маршрута охранника, вы берёте их изысканное устройство и выходите из лаборатории. В безопасности кладовки вы путешествуете во времени на несколько месяцев назад и записываете ночное состояние охранного поста лаборатории на стенах кладовки.

Вернувшись спустя несколько секунд к Историкам, они объясняют, что зона патрулирования охранника слишком велика, чтобы они могли безопасно обыскать лабораторию, не рискуя быть замеченными.

К счастью, они уверены, что добавление одного нового препятствия не вызовет временного парадокса. Им нужно разместить новое препятствие так, чтобы охранник застрял в цикле, что сделает остальную часть лаборатории безопасной для поиска.

Чтобы минимизировать вероятность временного парадокса, Историки хотят узнать все возможные позиции для такого препятствия. Новое препятствие нельзя разместить на стартовой позиции охранника — он там находится и заметит это.

В приведённом выше примере есть только 6 различных позиций, где новое препятствие может заставить охранника застрять в цикле. На диаграммах этих шести ситуаций символ O обозначает новое препятствие, | указывает позицию, где охранник движется вверх/вниз, - указывает позицию, где охранник движется влево/вправо, а + указывает позицию, где охранник движется в обоих направлениях.

**Опция первая**, разместить печатный станок рядом со стартовой позицией охранника:

```
....#.....
....+---+#
....|...|.
..#.|...|.
....|..#|.
....|...|.
.#.O^---+.
........#.
#.........
......#...
```

**Опция вторая**, разместить стопку неудачных прототипов костюмов в нижнем правом квадранте карты:

```
....#.....
....+---+#
....|...|.
..#.|...|.
..+-+-+#|.
..|.|.|.|.
.#+-^-+-+.
......O.#.
#.........
......#...
```

**Опция третья**, разместить ящик с тканью для прототипов рядом с письменным столом в нижнем правом квадранте:

```
....#.....
....+---+#
....|...|.
..#.|...|.
..+-+-+#|.
..|.|.|.|.
.#+-^-+-+.
.+----+O#.
#+----+...
......#...
```

**Опция четвёртая**, поместить алхимический ретроэнкабулятор рядом с нижним левым углом:

```
....#.....
....+---+#
....|...|.
..#.|...|.
..+-+-+#|.
..|.|.|.|.
.#+-^-+-+.
..|...|.#.
#O+---+...
......#...
```

**Опция пятая**, поместить алхимический ретроэнкабулятор немного правее:

```
....#.....
....+---+#
....|...|.
..#.|...|.
..+-+-+#|.
..|.|.|.|.
.#+-^-+-+.
....|.|.#.
#..O+-+...
......#...
```

**Опция шестая**, разместить резервуар с универсальным клеем рядом с резервуаром с универсальным растворителем:

```
....#.....
....+---+#
....|...|.
..#.|...|.
..+-+-+#|.
..|.|.|.|.
.#+-^-+-+.
.+----++#.
#+----++..
......#O..
```

В действительности неважно, какое препятствие вы решите использовать, главное, чтобы вы и Историки могли его установить, не привлекая внимания охранника. Важно лишь иметь достаточно вариантов, чтобы выбрать один из них, который минимизирует временные парадоксы. В этом примере есть 6 различных позиций, которые вы могли бы выбрать.

Добавьте новое препятствие, чтобы охранник застрял в цикле. **Сколько различных позиций можно выбрать для размещения этого препятствия?**