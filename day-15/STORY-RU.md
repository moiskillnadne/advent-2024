
# День 15: Складские Злоключения

Вы снова оказываетесь в своей мини-субмарине! Каждый из Историков управляет своей мини-субмариной в разных направлениях; возможно, у Главного тоже есть субмарина где-то здесь?

Вы поднимаете взгляд и видите огромное скопление светящихся рыб, проплывающих мимо вас. При ближайшем рассмотрении они кажутся очень обеспокоенными, поэтому вы подплываете, чтобы узнать, чем можете помочь.

Поскольку популяции светящихся рыб быстро растут, им требуется много еды, и эту еду нужно где-то хранить. Именно поэтому эти рыбы построили сложные складские комплексы, управляемые роботами!

Эти рыбы кажутся такими обеспокоенными, потому что они потеряли контроль над роботом, который управляет одним из их самых важных складов! Сейчас он ведёт себя хаотично, перемещая коробки по складу без учёта логистики и стратегий управления запасами.

На данный момент ни одна из рыб не осмеливается приблизиться к непредсказуемому роботу, чтобы выключить его. Однако если бы вы могли предсказать движения робота, они могли бы найти безопасное решение.

У светящихся рыб уже есть карта склада и список движений, которые робот попытается выполнить (ваш ввод задачи). Проблема в том, что движения иногда будут проваливаться, поскольку коробки перемещаются, что усложняет прогнозирование фактических движений робота.

Например:
```
##########
#..O..O.O#
#......O.#
#.OO..O.O#
#..O@..O.#
#O#..O...#
#O..O..O.#
#.OO.O.OO#
#....O...#
##########

<vv>^<v^>v>^vv^v>v<>v^v<v<^vv<<<^><<><>>v<vvv<>^v^>^<<<><<v<<<v^vv^v>^
```
Когда робот (@) пытается двигаться, если на его пути есть коробки (O), он также попытается сдвинуть эти коробки. Однако если это действие приведёт к перемещению робота или коробки в стену (#), ничего не двигается, включая самого робота. Начальные позиции указаны на карте.

Остальная часть документа описывает движения (^ для вверх, v для вниз, < для влево, > для вправо), которые робот попытается выполнить по порядку. (Движения представляют собой одну длинную последовательность; они разбиты на несколько строк для удобства копирования и вставки. Переносы строк в последовательности движений игнорируются.)

Вот более короткий пример для начала:
```
########
#..O.O.#
##@.O..#
#...O..#
#.#.O..#
#...O..#
#......#
########

<^^>>>vv<v>>v<<
```
Если бы робот попытался выполнить данную последовательность движений, он переместил бы коробки следующим образом:

Начальное состояние:
```
########
#..O.O.#
##@.O..#
#...O..#
#.#.O..#
#...O..#
#......#
########
```

Движение <:
```
########
#..O.O.#
##@.O..#
#...O..#
#.#.O..#
#...O..#
#......#
########
```

Движение ^:
```
########
#.@O.O.#
##..O..#
#...O..#
#.#.O..#
#...O..#
#......#
########
```

(Пример продолжается аналогичным образом с каждым движением.)

В большем примере робот завершает движения, и склад выглядит следующим образом:

```
##########
#.O.O.OOO#
#........#
#OO......#
#OO@.....#
#O#.....O#
#O.....OO#
#O.....OO#
#OO....OO#
##########
```
Светящиеся рыбы используют свою систему позиционирования товаров (Goods Positioning System, GPS) для отслеживания местоположения коробок. GPS-координата коробки равна 100, умноженному на её расстояние от верхнего края карты, плюс её расстояние от левого края карты.

После завершения всех движений вычислите сумму GPS-координат всех коробок. Например, в меньшем примере сумма составляет 2028.

## Часть Вторая 

Используя вашу информацию, светящиеся рыбы находят безопасный момент, чтобы выключить неисправного робота! Но как только они начинают готовить праздник в вашу честь, появляются сообщения о том, что робот на втором складе тоже неисправен.

На втором складе используется карта, вдвое более широкая, чем та, с которой вы уже работали. Однако список движений робота не изменяется.

Для получения карты более широкого склада, каждая плитка оригинальной карты заменяется следующим образом:

- Если плитка — это #, новая карта содержит ##.
- Если плитка — это O, новая карта содержит [].
- Если плитка — это ., новая карта содержит ..
- Если плитка — это @, новая карта содержит @.

Это приведёт к созданию новой карты склада, которая будет вдвое шире, с широкими коробками, представленными как []. (Робот остаётся того же размера.)

Более крупный пример теперь выглядит так:
```
####################
##....[]....[]..[]##
##............[]..##
##..[][]....[]..[]##
##....[]@.....[]..##
##[]##....[]......##
##[]....[]....[]..##
##..[][]..[]..[][]##
##........[]......##
####################
```

Поскольку коробки теперь вдвое шире, но робот остаётся того же размера и скорости, коробки могут быть выровнены так, чтобы непосредственно толкать две другие коробки одновременно.

Используя увеличенную карту, вычислите сумму GPS-координат всех коробок после завершения всех движений.
